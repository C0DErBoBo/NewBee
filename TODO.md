# TODO 工作拆解

## 0. 部署与同步自动化
- [x] 设计并实现一条命令的部署脚本/工具，调用 CloudBase CLI 或相关 API 完成构建与部署，每次修改需推送至 GitHub 保存版本并记录变更详情。
- [x] 建立并维护 GitHub Actions 流水线，覆盖依赖安装、测试、构建、部署 CloudBase 及回滚校验，确保流程可靠可追踪。
- [x] 执行部署脚本后，按模板更新 `CHANGELOG_DEPLOY.md`，记录时间、提交哈希、主要改动与回滚处理。

## 1. 项目初始化与基础设施
- [x] 初始化前端工程（React + TypeScript + Vite），配置 TailwindCSS 与 shadcn/ui 组件库。
- [x] 建立 Redux Toolkit 与 React Query 基础框架，定义全局 store 与接口缓存策略。
- [x] 初始化 Node.js + Express 后端工程，配置 TypeScript、ESLint、Prettier 及基础目录结构。
- [x] 搭建 PostgreSQL 连接与基础数据迁移方案（用户、赛事、项目、报名规则等核心表）。
- [x] 配置 Axios 请求封装与 JWT 鉴权中间件，确保前后端请求头格式一致。

## 2. 用户注册与登录
- [x] 设计用户数据模型（手机号、微信 OpenID、角色、状态等字段）。
- [x] 实现短信验证码登录流程：验证码生成、发送、校验与错误重试机制。
- [x] 对接微信授权登录（OpenID 绑定），并与现有账号合并策略。
- [x] 后端实现 JWT 签发、刷新与失效逻辑；保证会话安全策略符合需求。
- [x] 前端完成登录/注册页面：手机号验证码、微信授权入口、错误提示与状态反馈。
- [x] 编写接口与组件测试，覆盖验证码错误、刷新令牌等关键场景。

## 3. 赛事创建与配置
- [x] 后台提供办赛方 / 管理员角色按钮区分，确保各角色进入专属导航与权限范围。
- [x] 设计赛事、项目、组别、报名规则等数据库模型及关联关系。
- [x] 实现赛事创建 API：基本信息录入、时间地点、赛事模板选择。
- [x] 打通项目管理 API：内置标准田径项目 CRUD、自定义项目模板保存。
- [x] 实现组别与报名规则配置 API：性别、年龄段、身份、参赛人数、团队限制。
- [x] 构建赛程流程配置接口：预赛/决赛、晋级规则、成绩判定（最好成绩/累计）。
- [x] 处理异常与判罚规则（弃权、犯规、取消成绩）的配置与存储。
- [x] 管理员批量导入队伍信息（生成账号 + 随机密码），并提供导出账号与密码重置能力。
- [x] 前端构建赛事配置向导式页面：多步表单、进度保存、验证提示。
- [x] 为关键配置流程编写端到端测试，验证完整创建赛事的可用性。

## 4. 成绩与积分管理
- [ ] 设计积分规则模型，支持默认 9/7/6/5/4/3/2/1 模板与项目级覆写。
- [ ] 实现成绩录入与积分计算服务，支持个人与团体项目。
- [ ] 构建成绩异常处理逻辑：弃权、犯规、取消成绩等与积分联动。
- [ ] 前端提供成绩配置与预览界面，允许办赛方调整积分规则。

## 5. 报名与选手管理
- [ ] 实现报名 API：参赛选手选择项目、填写个人/团队信息、上传必要材料。
- [ ] 支持报名限制校验（每人最大项目数、团队人数匹配）。
- [ ] 构建参赛选手视图：赛事列表、报名状态、信息修改与撤销。
- [ ] 编写服务端校验测试，避免超额报名与重复报名等问题。

## 6. 数据导出与存储
- [ ] 开发赛事与报名信息导出服务，生成 CSV/JSON 文件。
- [ ] 集成 COS 存储导出文件，返回临时下载链接并设置有效期。
- [ ] 前端实现导出触发入口与状态反馈（生成中、成功、失败）。
- [ ] 记录导出操作日志，满足审计与追踪需求。

## 7. 监控、运维与安全
- [ ] 集成 Sentry（前端）与腾讯云日志服务（后端）收集运行指标与错误。
- [ ] 实现核心指标埋点：注册转化、赛事创建成功率、报名统计等。
- [ ] 落实 HTTPS、敏感信息加密、访问日志保留 ≥ 30 天的要求。
- [ ] 编写运维手册：环境变量管理、日志查看、应急方案。

## 8. 协作流程与文档同步
- [ ] 在 README/STATUS 中引用并链接 AGENTS.md，提醒团队遵循协作指南。
- [ ] 建立需求变更流程：需求更新 → 需求文档与 AGENTS 同步 → 更新 TODO 明细。
- [ ] 定期审查 TODO 项完成情况，确保需求覆盖与优先级符合业务目标。
